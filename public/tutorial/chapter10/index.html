<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  
  <title>P5 Code School Chapter10「座標変換」</title>
  <meta name="description" content="ゼロから学べるProcessing入門サイト">

  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
  <link href="https://fonts.googleapis.com/earlyaccess/notosansjp.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
<div id="BgCanvasContainer"></div>
<div class="pageContainer">

<header class="header">
  <div class="inner">
    <h1 class="header__siteTitle">
      <a href="/">p5 code school</a>
    </h1>
    
    <ul class="mainNavigation">
      <li class="mainNavigation__item">
        <a href="/tutorial/">Tutorials</a>
      </li>
      <li class="mainNavigation__item">
        <a href="/examples/">Examples</a>
      </li>
    </ul>
  </div>
</header>


<main class="mainContents">
  <h1>座標変換</h1><p>このChapterでは座標の移動、回転、拡大縮小を行う関数を紹介していきます。</p>
<h2>原点の移動</h2><p>Processingでは、原点(0, 0)はウィンドウの左上の角にありましたが、translate関数を使うと原点をウィンドウの好きな位置に変えることができます。次のプログラムでは原点を画面中心に移動させたあと、３つの円を描画しています。</p>
<p><img src="/images/Chapter10/sketch01.jpg" alt=""></p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch01/sketch01.pde' target='_blank'>Chapter10/sketch01.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
<span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);
<span class="hljs-built_in">noStroke</span>();

<span class="hljs-comment">// 原点を画面中心に移動</span>
<span class="hljs-built_in">translate</span>(<span class="hljs-built_in">width</span>/<span class="hljs-number">2</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span>);

<span class="hljs-comment">// 座標(-200, -100)に赤色の円を描画</span>
<span class="hljs-built_in">fill</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">-200</span>, <span class="hljs-number">-100</span>, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>);

<span class="hljs-comment">// 原点に緑色の円を描画</span>
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>);

<span class="hljs-comment">// 座標(200, 100)に青色の円を描画</span>
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">200</span>, <span class="hljs-number">100</span>, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>);
</code></pre>
<p>translate(width/2, height/2)を実行すると、ウィンドウの座標は次のように変わります。</p>
<p><img src="/images/Chapter10/translate.jpg" alt=""></p>
<p>原点の位置がウィンドウの左上角にあるよりも画面中心にあったほうが考えやすい場合も多いので、translate(width/2, height/2)はこの先よく使うことになると思います。</p>
<p>translate()を２回以上使うと、原点の移動量は加算されていきます。次のプログラムを見てください。</p>
<p><img src="/images/Chapter10/sketch02.jpg" alt=""></p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch02/sketch02.pde' target='_blank'>Chapter10/sketch02.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
<span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);
<span class="hljs-built_in">noStroke</span>();

<span class="hljs-comment">// 原点を座標(100, 50)に移動</span>
<span class="hljs-built_in">translate</span>(<span class="hljs-number">100</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">// 原点に赤色の円を描画</span>
<span class="hljs-built_in">fill</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>);

<span class="hljs-comment">// 原点を座標(200, 100)に移動</span>
<span class="hljs-built_in">translate</span>(<span class="hljs-number">100</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">// 原点に緑色の円を描画</span>
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>);

<span class="hljs-comment">// 原点を座標(300, 150)に移動</span>
<span class="hljs-built_in">translate</span>(<span class="hljs-number">100</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">// 原点に青色の円を描画</span>
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>);
</code></pre>
<p>translate(100, 50)を３回使っていますが、その時の原点は座標(100, 50)、(200, 100)、(300, 150)に移動されます。</p>
<p>pushMatrix()とpopMatrix()を使うとtranslate()によって移動された原点の位置を、移動する前の位置に戻すことができます。</p>
<p><img src="/images/Chapter10/sketch03.jpg" alt=""></p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch03/sketch03.pde' target='_blank'>Chapter10/sketch03.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
<span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);
<span class="hljs-built_in">noStroke</span>();

<span class="hljs-comment">// 現在の座標情報を保存</span>
<span class="hljs-built_in">pushMatrix</span>();
<span class="hljs-comment">// 原点を座標(width/2-200, height/2-100)に移動</span>
<span class="hljs-built_in">translate</span>(<span class="hljs-built_in">width</span>/<span class="hljs-number">2</span><span class="hljs-number">-200</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span><span class="hljs-number">-100</span>);
<span class="hljs-comment">// 原点に赤色の円を描画</span>
<span class="hljs-built_in">fill</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>);
<span class="hljs-comment">// 現在の座標情報を変換前に戻す</span>
<span class="hljs-built_in">popMatrix</span>();

<span class="hljs-built_in">pushMatrix</span>();
<span class="hljs-comment">// 原点を座標(width/2, height/2)に移動</span>
<span class="hljs-built_in">translate</span>(<span class="hljs-built_in">width</span>/<span class="hljs-number">2</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span>);
<span class="hljs-comment">// 原点に緑色の円を描画</span>
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>);
<span class="hljs-built_in">popMatrix</span>();

<span class="hljs-built_in">pushMatrix</span>();
<span class="hljs-comment">// 原点を座標(width/2+200, height/2+100)に移動</span>
<span class="hljs-built_in">translate</span>(<span class="hljs-built_in">width</span>/<span class="hljs-number">2</span>+<span class="hljs-number">200</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span>+<span class="hljs-number">100</span>);
<span class="hljs-comment">// 原点に青色の円を描画</span>
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">80</span>, <span class="hljs-number">80</span>);
<span class="hljs-built_in">popMatrix</span>();
</code></pre>
<p>translate()を３回使っていますが、原点の移動量が加算されていないことがわかると思います。pushMatrix()によって現在の座標情報を保存し、popMatrix()によって変換前の座標情報に戻しているからです。pushMatrix()とpopMatrix()には数学における行列の話が絡んでくるのですが、パパッと解説できるようなものではないので止めておきます。pushMatrix()とpopMatrix()を使う分には、とりあえずpushMatrix()で現在の座標情報を保存してpopMatrix()で戻す、という理解で十分かと思います。</p>
<p>translate()やこのあと解説するrotate()、scale()などによって変換された座標情報はdraw()の度にリセットされます。次のプログラムでは、pushMatrix()、popMatrix()を使わずにdraw()の中でtranslate()を実行していますが、draw()の度に原点の移動量が増えるわけではないことがわかります。</p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch04/sketch04.pde' target='_blank'>Chapter10/sketch04.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span>() {
  <span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
  <span class="hljs-built_in">noStroke</span>();
  <span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>);
}

<span class="hljs-keyword">void</span> <span class="hljs-title">draw</span>() {
  <span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);
  <span class="hljs-comment">// 原点を画面中心に移動</span>
  <span class="hljs-built_in">translate</span>(<span class="hljs-built_in">width</span>/<span class="hljs-number">2</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span>);
  <span class="hljs-comment">// 原点に円を描画</span>
  <span class="hljs-built_in">ellipse</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">150</span>, <span class="hljs-number">150</span>);
}
</code></pre>
<h2>回転</h2><p>rotate()を使うと座標を回転させることができます。パラメータにはラジアンで表された角度を指定します。次のプログラムではx軸に平行な(傾いていない)長方形と30度回転した長方形、60度回転した長方形を描画しています。</p>
<p><img src="/images/Chapter10/sketch05.jpg" alt=""></p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch05/sketch05.pde' target='_blank'>Chapter10/sketch05.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
<span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);
<span class="hljs-built_in">noStroke</span>();

<span class="hljs-comment">// 回転していない赤色の長方形</span>
<span class="hljs-built_in">fill</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">540</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">// 30度回転した青色の長方形</span>
<span class="hljs-built_in">rotate</span>(<span class="hljs-built_in">radians</span>(<span class="hljs-number">30</span>));
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">540</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">// 60度回転した青色の長方形</span>
<span class="hljs-built_in">rotate</span>(<span class="hljs-built_in">radians</span>(<span class="hljs-number">30</span>));
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>);
<span class="hljs-built_in">rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">540</span>, <span class="hljs-number">50</span>);
</code></pre>
<p>translate()による原点の移動量が加算されていったように、rotate()による座標の回転も加算されていきます。上のプログラムでは２回目のrotate(30)で座標が60度回転されています。</p>
<p>rotate()による座標の回転は常に原点を中心にして回転されます。translate()で原点を画面中心に移動させた場合は次のようになります。</p>
<p><img src="/images/Chapter10/sketch06.jpg" alt=""></p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch06/sketch06.pde' target='_blank'>Chapter10/sketch06.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
<span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);
<span class="hljs-built_in">rectMode</span>(CENTER);
<span class="hljs-built_in">noStroke</span>();

<span class="hljs-comment">// 原点を画面中心に移動</span>
<span class="hljs-built_in">translate</span>(<span class="hljs-built_in">width</span>/<span class="hljs-number">2</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span>);

<span class="hljs-comment">// 回転していない赤色の長方形</span>
<span class="hljs-built_in">fill</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">500</span>, <span class="hljs-number">30</span>);

<span class="hljs-comment">// 30度回転した青色の長方形</span>
<span class="hljs-built_in">rotate</span>(<span class="hljs-built_in">radians</span>(<span class="hljs-number">30</span>));
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">500</span>, <span class="hljs-number">30</span>);

<span class="hljs-comment">// 60度回転した青色の長方形</span>
<span class="hljs-built_in">rotate</span>(<span class="hljs-built_in">radians</span>(<span class="hljs-number">30</span>));
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>);
<span class="hljs-built_in">rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">500</span>, <span class="hljs-number">30</span>);
</code></pre>
<p>注意が必要なのは、rotate()は座標全体、いわば図形が描画される世界全体を回転させます。上のプログラムでは、傾いた世界に平行な線を描画しています。平行な世界に傾いた線を描画しているわけではないです。translate()やrotate()とこれから解説するscale()は、個々の図形を移動させたり回転させたり拡大縮小させたりする関数ではありません。translate()は世界の原点を移動させ、rotate()は世界全体を回転させ、scale()は世界全体を拡大縮小させます。ただ、pushMatrix()とpopMatrix()を上手く使うと、個々の図形が回転や拡大縮小をしているように見せることはできます。方法はscale()を紹介したあとに解説します。</p>
<h2>拡大縮小</h2><p>scale()を使うと座標全体を拡大縮小することができます。scale()のパラーメータには何倍するかを表す数値をfloat型で指定します。2.5倍したい場合は</p>
<p><code class='codeFragment'>scale(2.5);</code></p>
<p>とします。パラメータを２つ与えた場合は、１つ目がx軸方向に何倍するかを表し、２つ目がy軸方向に何倍するかを表します。</p>
<p><code class='codeFragment'>scale(4.0, 0.5);</code></p>
<p><img src="/images/Chapter10/sketch07.jpg" alt=""></p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch07/sketch07.pde' target='_blank'>Chapter10/sketch07.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
<span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);
<span class="hljs-built_in">fill</span>(<span class="hljs-number">220</span>);

<span class="hljs-comment">// 赤色の円</span>
<span class="hljs-built_in">stroke</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">// 2倍に拡大された緑色の円</span>
<span class="hljs-built_in">scale</span>(<span class="hljs-number">2.0</span>);
<span class="hljs-built_in">stroke</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">// 4倍に拡大された青色の円</span>
<span class="hljs-built_in">scale</span>(<span class="hljs-number">2.0</span>);
<span class="hljs-built_in">stroke</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);
</code></pre>
<p><img src="/images/Chapter10/sketch08.jpg" alt=""></p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch08/sketch08.pde' target='_blank'>Chapter10/sketch08.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
<span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);
<span class="hljs-built_in">fill</span>(<span class="hljs-number">220</span>);

<span class="hljs-built_in">stroke</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">// x軸方向に4倍、y軸方向に2倍拡大された緑色の円</span>
<span class="hljs-built_in">scale</span>(<span class="hljs-number">4.0</span>, <span class="hljs-number">2.0</span>);
<span class="hljs-built_in">stroke</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);
</code></pre>
<p>scale()によって座標を拡大縮小すると、描かれる図形の枠線の太さも拡大縮小されます。図形だけを拡大縮小して枠線の太さをそのままに保ちたい場合は次のようにします。</p>
<p><img src="/images/Chapter10/sketch09.jpg" alt=""></p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch09/sketch09.pde' target='_blank'>Chapter10/sketch09.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
<span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);
<span class="hljs-built_in">fill</span>(<span class="hljs-number">220</span>);

<span class="hljs-comment">// 赤色の円</span>
<span class="hljs-built_in">stroke</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);

<span class="hljs-built_in">float</span> s = <span class="hljs-number">2.0</span>;

<span class="hljs-comment">// 2倍に拡大された緑色の円</span>
<span class="hljs-built_in">scale</span>(s);
<span class="hljs-built_in">stroke</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>);
<span class="hljs-comment">// 枠線の太さを維持</span>
<span class="hljs-built_in">strokeWeight</span>(<span class="hljs-number">1.0</span>/s);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">// 4倍に拡大された青色の円</span>
<span class="hljs-built_in">scale</span>(s);
<span class="hljs-built_in">stroke</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>);
<span class="hljs-comment">// 枠線の太さを維持</span>
<span class="hljs-built_in">strokeWeight</span>(<span class="hljs-number">1.0</span>/(s*s));
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);
</code></pre>
<p>translate()で原点を画面中心に移動させた場合は次のようになります。</p>
<p><img src="/images/Chapter10/sketch10.jpg" alt=""></p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch10/sketch10.pde' target='_blank'>Chapter10/sketch10.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
<span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);
<span class="hljs-built_in">noFill</span>();

<span class="hljs-comment">// 原点を画面中心に移動</span>
<span class="hljs-built_in">translate</span>(<span class="hljs-built_in">width</span>/<span class="hljs-number">2</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span>);

<span class="hljs-comment">// 赤色の円</span>
<span class="hljs-built_in">stroke</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">// 2倍に拡大された緑色の円</span>
<span class="hljs-built_in">scale</span>(<span class="hljs-number">2.0</span>);
<span class="hljs-built_in">stroke</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);

<span class="hljs-comment">// 4倍に拡大された青色の円</span>
<span class="hljs-built_in">scale</span>(<span class="hljs-number">2.0</span>);
<span class="hljs-built_in">stroke</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>);
<span class="hljs-built_in">ellipse</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);
</code></pre>
<h2>個々の図形の変形</h2><p>今までに解説してきた、pusuMatrix()、popMatrix()、translate()、rotate()、scale()を使って、個々の図形が回転したり拡大縮小してるように見せる方法を解説します。次のような手順を踏めば、図形ごとの回転と、拡大縮小を表現できます。</p>
<p>１：pushMatrix()で現在の座標情報を保存する<br>
２：translate()で図形を描画する位置に原点を移動させる<br>
３：rotate()やscale()で回転、拡大縮小を行う<br>
４：原点に図形を描画<br>
５：popMatrix()で座標情報を戻す</p>
<p><img src="/images/Chapter10/sketch11.jpg" alt=""></p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch11/sketch11.pde' target='_blank'>Chapter10/sketch11.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
<span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);
<span class="hljs-built_in">stroke</span>(<span class="hljs-number">0</span>);
<span class="hljs-built_in">strokeWeight</span>(<span class="hljs-number">5</span>);
<span class="hljs-built_in">rectMode</span>(CENTER);

<span class="hljs-comment">// 現在の座標情報を保存</span>
<span class="hljs-built_in">pushMatrix</span>();
<span class="hljs-comment">// 原点を画面中心に移動</span>
<span class="hljs-built_in">translate</span>(<span class="hljs-number">200</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span>);
<span class="hljs-comment">// 回転と拡大</span>
<span class="hljs-built_in">rotate</span>(<span class="hljs-built_in">radians</span>(<span class="hljs-number">45</span>));
<span class="hljs-built_in">scale</span>(<span class="hljs-number">2.0</span>);
<span class="hljs-built_in">fill</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-comment">// 原点に長方形と点を描く</span>
<span class="hljs-built_in">rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">40</span>);
<span class="hljs-built_in">point</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-comment">// 座標情報を変換前に戻す</span>
<span class="hljs-built_in">popMatrix</span>();

<span class="hljs-built_in">pushMatrix</span>();
<span class="hljs-built_in">translate</span>(<span class="hljs-built_in">width</span>/<span class="hljs-number">2</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span>);
<span class="hljs-comment">// 回転と拡大</span>
<span class="hljs-built_in">rotate</span>(<span class="hljs-built_in">radians</span>(<span class="hljs-number">-45</span>));
<span class="hljs-built_in">scale</span>(<span class="hljs-number">1.5</span>, <span class="hljs-number">2.0</span>);
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">40</span>);
<span class="hljs-built_in">point</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">popMatrix</span>();

<span class="hljs-built_in">pushMatrix</span>();
<span class="hljs-built_in">translate</span>(<span class="hljs-number">700</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span>);
<span class="hljs-comment">// 回転と拡大</span>
<span class="hljs-built_in">rotate</span>(<span class="hljs-built_in">radians</span>(<span class="hljs-number">90</span>));
<span class="hljs-built_in">scale</span>(<span class="hljs-number">3.0</span>);
<span class="hljs-built_in">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>);
<span class="hljs-built_in">rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">40</span>);
<span class="hljs-built_in">point</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">popMatrix</span>();
</code></pre>
<p>図形の１つ１つをpushMatrix()とpopMatrix()で囲っているので、前に行った座標変換のことを気にする必要がありません。translate()で図形を描画したい位置に原点を移動させ、原点に図形を描画しているので、rotate()とscale()が個々の図形を回転させたり拡大縮小を行っているように見えます。</p>
<p>draw()を使ってアニメーションにしてみましょう。</p>
<p><a href='https://github.com/p5aholic/p5codeschool-samples/tree/master/Chapter10/sketch12/sketch12.pde' target='_blank'>Chapter10/sketch12.pde</a></p>
<pre><code class="lang-processing"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span>() {
  <span class="hljs-built_in">size</span>(<span class="hljs-number">960</span>, <span class="hljs-number">540</span>);
  <span class="hljs-built_in">rectMode</span>(CENTER);
  <span class="hljs-built_in">stroke</span>(<span class="hljs-number">0</span>);
  <span class="hljs-built_in">strokeWeight</span>(<span class="hljs-number">5</span>);
  <span class="hljs-built_in">fill</span>(<span class="hljs-number">128</span>);
}

<span class="hljs-keyword">void</span> <span class="hljs-title">draw</span>() {
  <span class="hljs-built_in">background</span>(<span class="hljs-number">255</span>);

  <span class="hljs-comment">// 時計周りに回転する正方形</span>
  <span class="hljs-built_in">pushMatrix</span>();
  <span class="hljs-built_in">translate</span>(<span class="hljs-built_in">width</span>/<span class="hljs-number">2</span><span class="hljs-number">-100</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span>);
  <span class="hljs-built_in">rotate</span>(<span class="hljs-built_in">frameCount</span>*<span class="hljs-number">0.05</span>);
  <span class="hljs-built_in">rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);
  <span class="hljs-built_in">popMatrix</span>();

  <span class="hljs-comment">// 反時計回りに回転する正方形</span>
  <span class="hljs-built_in">pushMatrix</span>();
  <span class="hljs-built_in">translate</span>(<span class="hljs-built_in">width</span>/<span class="hljs-number">2</span>+<span class="hljs-number">100</span>, <span class="hljs-built_in">height</span>/<span class="hljs-number">2</span>);
  <span class="hljs-built_in">rotate</span>(-<span class="hljs-built_in">frameCount</span>*<span class="hljs-number">0.05</span>);
  <span class="hljs-built_in">rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);
  <span class="hljs-built_in">popMatrix</span>();
}
</code></pre>
<p>rotate()のパラメータにframeCountを使いました。回転するアニメーションを作る場合はrotate()に指定する角度を少しずつ増加させなければいけません。frameCountはdraw()ごとに+1ずつされていくので、回転するアニメーションなどに使うと便利です。frameCountに掛ける値を増加させると回転速度が上がります。</p>
<p>これで、本来個々の図形を回転させたり拡大縮小させるものではないrotate()とscale()を、pushMatrix()、translate()、popMatrix()を使って個々の図形が回転したり拡大縮小したりしてるように見せる方法がわかったかと思います。</p>
<p>お疲れさまでした。Chapter10はこれで終了です。</p>

</main>

<footer class="footer">
  <div class="inner">
    <p class="copyright">&copy P5 Code School 2017</p>
  </div>
</footer>


</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

</body>
</html>
